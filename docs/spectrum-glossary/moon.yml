$schema: "https://moonrepo.dev/schemas/project.json"

type: application
language: javascript
platform: node

fileGroups:
  sources:
    - "src/**/*"
  assets:
    - "src/assets/**/*"
  scripts:
    - "scripts/**/*"
  configs:
    - ".eleventy.js"
    - "package.json"

tasks:
  build:
    command: pnpm build
    platform: node
    env:
      BASE_PATH: "/spectrum-design-data/glossary"
    inputs:
      - "@group(sources)"
      - "@group(assets)"
      - "@group(scripts)"
      - "@group(configs)"
      - "~:design-system-registry"
    # Don't cache dist as output - export task needs it to persist

  export:
    command: ./scripts/export-to-site.sh
    deps:
      - ~:build
    platform: system
    local: true # Only needed for deploy-docs workflow, not CI
    outputs:
      - /site/glossary/

  dev:
    command: pnpm start
    platform: node
    local: true

  clean:
    command: pnpm clean
    platform: node
